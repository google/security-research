from enum import Enum

MIG_NONE = "MIG_NONE"
MIG_MB = "MIG_MB"
MIG_CBO = "MIG_CBO"

global_sys_metadata_lookup_list = [
    {
        "name": "NUM_PKGS",
        "field_id": 0x0000000200000000,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "PKG_FMS",
        "field_id": 0x0000000200000001,
        "num_of_fields": 8,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0xFFFFFFFF,
        "import_mask": 0xFFFFFFFF,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_MB,
        "mig_import": MIG_CBO,
    },
    {
        "name": "VENDOR_ID",
        "field_id": 0x0800000200000000,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFFFFFFFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0xFFFFFFFF,
        "import_mask": 0xFFFFFFFF,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_MB,
        "mig_import": MIG_CBO,
    },
    {
        "name": "BUILD_DATE",
        "field_id": 0x8800000200000001,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0xFFFFFFFF,
        "import_mask": 0xFFFFFFFF,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_MB,
        "mig_import": MIG_CBO,
    },
    {
        "name": "BUILD_NUM",
        "field_id": 0x8800000100000002,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0xFFFF,
        "import_mask": 0xFFFF,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_MB,
        "mig_import": MIG_CBO,
    },
    {
        "name": "MINOR_VERSION",
        "field_id": 0x0800000100000003,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFFFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0xFFFF,
        "import_mask": 0xFFFF,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_MB,
        "mig_import": MIG_CBO,
    },
    {
        "name": "MAJOR_VERSION",
        "field_id": 0x0800000100000004,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFFFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0xFFFF,
        "import_mask": 0xFFFF,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_MB,
        "mig_import": MIG_CBO,
    },
    {
        "name": "UPDATE_VERSION",
        "field_id": 0x0800000100000005,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0xFFFF,
        "import_mask": 0xFFFF,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_MB,
        "mig_import": MIG_CBO,
    },
    {
        "name": "INTERNAL_VERSION",
        "field_id": 0x0800000100000006,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0xFFFF,
        "import_mask": 0xFFFF,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_MB,
        "mig_import": MIG_CBO,
    },
    {
        "name": "MODULE_HV",
        "field_id": 0x8900000100000000,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MIN_UPDATE_HV",
        "field_id": 0x8900000100000001,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "NO_DOWNGRADE",
        "field_id": 0x8900000000000002,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "NUM_HANDOFF_PAGES",
        "field_id": 0x8900000100000003,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "HANDOFF_DATA_VALID",
        "field_id": 0x8900000000000004,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "HANDOFF_DATA_HV",
        "field_id": 0x8900000100000005,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "HANDOFF_DATA_SIZE",
        "field_id": 0x8900000200000006,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "SYS_ATTRIBUTES",
        "field_id": 0x0A00000200000000,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFFFFFFFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0xFFFFFFFF,
        "import_mask": 0xFFFFFFFF,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_MB,
        "mig_import": MIG_CBO,
    },
    {
        "name": "NUM_TDX_FEATURES",
        "field_id": 0x0A00000000000001,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0xFF,
        "import_mask": 0xFF,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_MB,
        "mig_import": MIG_CBO,
    },
    {
        "name": "TDX_FEATURES0",
        "field_id": 0x0A00000300000008,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0xFFFFFFFFFFFFFFFF,
        "import_mask": 0xFFFFFFFFFFFFFFFF,
        "special_rd_handling": True,
        "special_wr_handling": False,
        "mig_export": MIG_MB,
        "mig_import": MIG_CBO,
    },
    {
        "name": "NUM_CMRS",
        "field_id": 0x9000000100000000,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "CMR_BASE",
        "field_id": 0x9000000300000080,
        "num_of_fields": 32,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "CMR_SIZE",
        "field_id": 0x9000000300000100,
        "num_of_fields": 32,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MAX_TDMRS",
        "field_id": 0x9100000100000008,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MAX_RESERVED_PER_TDMR",
        "field_id": 0x9100000100000009,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "PAMT_4K_ENTRY_SIZE",
        "field_id": 0x9100000100000010,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "PAMT_2M_ENTRY_SIZE",
        "field_id": 0x9100000100000011,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "PAMT_1G_ENTRY_SIZE",
        "field_id": 0x9100000100000012,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "TDR_BASE_SIZE",
        "field_id": 0x9800000100000000,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "TDCS_BASE_SIZE",
        "field_id": 0x9800000100000100,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "TDCS_SIZE_PER_L2_VM",
        "field_id": 0x9800000100000101,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "TDVPS_BASE_SIZE",
        "field_id": 0x9800000100000200,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "TDVPS_SIZE_PER_L2_VM",
        "field_id": 0x9800000100000201,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "ATTRIBUTES_FIXED0",
        "field_id": 0x1900000300000000,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "ATTRIBUTES_FIXED1",
        "field_id": 0x1900000300000001,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "XFAM_FIXED0",
        "field_id": 0x1900000300000002,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": True,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "XFAM_FIXED1",
        "field_id": 0x1900000300000003,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "NUM_CPUID_CONFIG",
        "field_id": 0x9900000100000004,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "CONFIG_FLAGS_FIXED0",
        "field_id": 0x9900000300000006,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "CONFIG_FLAGS_FIXED1",
        "field_id": 0x9900000300000007,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MAX_VCPUS_PER_TD",
        "field_id": 0x9900000100000008,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MIN_VIRT_MAXPA",
        "field_id": 0x9900000000000009,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MAX_EVENT_FILTERS",
        "field_id": 0x990000010000000A,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "CPUID_CONFIG_LEAVES",
        "field_id": 0x9900000300000400,
        "num_of_fields": 32,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": True,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "CPUID_CONFIG_VALUES",
        "field_id": 0x9900000300000500,
        "num_of_fields": 32,
        "num_of_elem": 2,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": True,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "IA32_ARCH_CAPABILITIES_CONFIG_MASK",
        "field_id": 0x9900000300000600,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "NUM_ALLOWED_FMS",
        "field_id": 0x9900000100000800,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": True,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "NUM_DISALLOWED_FMS",
        "field_id": 0x9900000100000801,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": True,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "ALLOWED_FMS",
        "field_id": 0x9900000300000810,
        "num_of_fields": 64,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": True,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "DISALLOWED_FMS",
        "field_id": 0x9900000300000850,
        "num_of_fields": 64,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": True,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MIG_ATTRIBUTES",
        "field_id": 0xA000000300000000,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MIN_EXPORT_VERSION",
        "field_id": 0x2000000100000001,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFFFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MAX_EXPORT_VERSION",
        "field_id": 0x2000000100000002,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFFFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MIN_IMPORT_VERSION",
        "field_id": 0x2000000100000003,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFFFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MAX_IMPORT_VERSION",
        "field_id": 0x2000000100000004,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFFFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MAX_MIGS",
        "field_id": 0xA000000100000010,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "NUM_IMMUTABLE_STATE_PAGES",
        "field_id": 0xA000000000000020,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "NUM_TD_STATE_PAGES",
        "field_id": 0xA000000000000021,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "NUM_VP_STATE_PAGES",
        "field_id": 0xA000000000000022,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "MAX_SERV_TDS",
        "field_id": 0xA100000100000000,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "SERVTD_ATTR_FIXED0",
        "field_id": 0xA100000300000001,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "SERVTD_ATTR_FIXED1",
        "field_id": 0xA100000300000002,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "GUEST_L2_GPA_ATTR_MASK",
        "field_id": 0xA200000100000000,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0xFFFF,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "VM_CTLS_FIXED0",
        "field_id": 0xA200000300000001,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "VM_CTLS_FIXED1",
        "field_id": 0xA200000300000002,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "VPCU_L2_CTLS_FIXED0",
        "field_id": 0xA200000300000003,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "VCPU_L2_CTLS_FIXED1",
        "field_id": 0xA200000300000004,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "VPCU_L2_DEBUG_CTLS_FIXED0",
        "field_id": 0xA200000300000005,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
    {
        "name": "VCPU_L2_DEBUG_CTLS_FIXED1",
        "field_id": 0xA200000300000006,
        "num_of_fields": 1,
        "num_of_elem": 1,
        "vmm_rd_mask": 0xFFFFFFFFFFFFFFFF,
        "vmm_wr_mask": 0x0,
        "guest_rd_mask": 0x0,
        "guest_wr_mask": 0x0,
        "export_mask": 0x0,
        "import_mask": 0x0,
        "special_rd_handling": False,
        "special_wr_handling": False,
        "mig_export": MIG_NONE,
        "mig_import": MIG_NONE,
    },
]


class GlobalSysMetadataClassCode(Enum):
  MD_SYS_TDX_MODULE_INFO_CLASS_CODE = 10
  MD_SYS_TD_CONTROL_STRUCTURES_CLASS_CODE = 24
  MD_SYS_TD_PARTITIONING_CLASS_CODE = 34
  MD_SYS_PLATFORM_INFO_CLASS_CODE = 0
  MD_SYS_MIGRATION_CLASS_CODE = 32
  MD_SYS_TDX_MODULE_VERSION_CLASS_CODE = 8
  MD_SYS_TDMR_INFO_CLASS_CODE = 17
  MD_SYS_TD_CONFIGURABILITY_CLASS_CODE = 25
  MD_SYS_SERVICE_TD_CLASS_CODE = 33
  MD_SYS_TDX_MODULE_HANDOFF_CLASS_CODE = 9
  MD_SYS_CMR_INFO_CLASS_CODE = 16
  MD_SYS_RESERVED_CLASS_CODE = 0xFFFFFFFFFFFFFFFF


def global_sys_metadata_lookup_entry(field_id: int) -> dict | None:
  for entry in global_sys_metadata_lookup_list:
    if (field_id >= entry["field_id"]) and (
        field_id
        < entry["field_id"] + (entry["num_of_fields"] * entry["num_of_elem"])
    ):
      return entry

  return None


def global_sys_metadata_class_code_valid(class_code: int) -> bool:
  try:
    if GlobalSysMetadataClassCode(class_code):
      return True
  except ValueError:
    return False
