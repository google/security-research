{
    "$schema": "https://google.github.io/security-research/kernelctf/metadata.schema.v3.json",
    "submission_ids": [
        "exp424"
    ],
    "vulnerability": {
        "summary": "UAF of an xfrm_state when xfrm_alloc_spi creates an xfrm_state with .id.spi=0",
        "patch_commit": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/net/xfrm?id=cd8ae32e4e4652db55bce6b9c79267d8946765a9",
        "cve": "CVE-2025-39965",
        "affected_versions": [
            "6.17-rc1 - 6.17-rc7",
            "6.16.2 - 6.16.9",
            "6.12.43 - 6.12.49",
            "6.6.103 - 6.6.108"
        ],
        "requirements": {
            "attack_surface": [
                "userns"
            ],
            "capabilities": [
                "CAP_NET_ADMIN"
            ],
            "kernel_config": [
                "CONFIG_XFRM"
            ]
        },
        "syzkaller_reference": "https://syzkaller.appspot.com/bug?extid=a25ee9d20d31e483ba7b"
    },
    "exploits": {
        "cos-121-18867.199.65": {
            "environment": "cos-121-18867.199.65",
            "uses": [
                "userns"
            ],
            "requires_separate_kaslr_leak": false,
            "stability_notes": "19 out of 20"
        }
    }
}