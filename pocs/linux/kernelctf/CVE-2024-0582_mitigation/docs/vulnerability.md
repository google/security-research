# Vulneribility
A page-level use-after-free flaw was found in the Linux kernelâ€™s io_uring functionality in how a user registers a buffer ring with `IORING_REGISTER_PBUF_RING`, mmap() it, and then frees it.

## Requirements to trigger the vulnerability
 - Capabilities:  N / A
 - Kernel configuration: `CONFIG_IO_URING`
 - Are user namespaces needed?: N / A

## Commit which introduced the vulnerability
[io_uring: add support for user mapped provided buffer ring](https://github.com/torvalds/linux/commit/c56e022c0a27142b7b59ae6bdf45f86bf4b298a1)

## Commit which fixed the vulnerability

[io_uring/kbuf: defer release of mapped buffer rings](https://github.com/torvalds/linux/commit/c392cbecd8eca4c53f2bf508731257d9d0a21c2d)

## Affected kernel versions

- before 6.6.5

## Affected component, subsystem
- io_uring

## Cause
- UAF

## Related syscalls

- io_uring_setup
- io_uring_register

## CVE URL

[NVD - cve-2024-0582](https://nvd.nist.gov/vuln/detail/cve-2024-0582)