# Vulneribility
 A new `tcx_entry` object is allocated when creating an ingress/clsact qdisc if one does not already exist. However, when creating a second ingress/clsact qdisc, if a `tcx_entry` already exists, it will be reused, so it's possible to have multiple qdiscs referencing the same `tcx_entry` object. For that reason, the `miniq_active` bool used to track the view of `tcx_entry` in qdisc should be replaced by a counter.

## Requirements to trigger the vulnerability
 - Capabilities:  `CAP_NET_ADMIN`
 - Kernel configuration: `CONFIG_USER_NS`, `CONFIG_NET_SCH_INGRESS`
 - Are user namespaces needed?: Yes
  
## Commit which introduced the vulnerability
 - [commit e420bed025071a623d2720a92bc2245c84757ecb]( https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e420bed025071a623d2720a92bc2245c84757ecb)

## Commit which fixed the vulnerability
- [commit 1cb6f0bae50441f4b4b32a28315853b279c7404e](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1cb6f0bae50441f4b4b32a28315853b279c7404e)

## Affected kernel versions
- 6.6.0 - 6.9.8

## Affected component, subsystem
- net/sched (ingress/clsact)

## Cause
- UAF
