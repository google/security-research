# Vulneribility
In the function `xfrmi_changelink`, when using `xfrmi_unlink` and `xfrmi_link` to change the linked list of a struct `xfrm_if`, the pointer that may be left in `xfrmn->collect_md_xfrmi` is not cleared

## Requirements to trigger the vulnerability
 - Kernel configuration: `CONFIG_XFRM ` and `CONFIG_XFRM_INTERFACE`
 - Are user namespaces needed?: Yes

## Commit which introduced the vulnerability
 - [commit abc340b38ba25cd6c7aa2c0bd9150d30738c82d0](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/net/xfrm/xfrm_interface.c?id=abc340b38ba25cd6c7aa2c0bd9150d30738c82d0)

## Commit which fixed the vulnerability
- [commit bfebdb85496e1da21d3cf05de099210915c3e706](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bfebdb85496e1da21d3cf05de099210915c3e706))

## Affected kernel versions
- 6.6-rc1 and later 
- 6.1-rc1 and later 

## Affected component, subsystem
- xfrm

## Cause
- Use after free