# Vulneribility
A race between mremap (move_normal_pmd) and MADVISE_COLLAPSE (retract_page_tables) was found in the mm/remap functionality in the Linux kernel. 

## Requirements to trigger the vulnerability
 - Capabilities:  N / A
 - Kernel configuration: N / A
 - Are user namespaces needed?: Yes

## Commit which introduced the vulnerability
[mm/khugepaged: retract_page_tables() without mmap or vma lock](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1d65b771bc08cd054cf6d3766a72e113dc46d62f)

## Commit which fixed the vulnerability
[mm/mremap: fix move_normal_pmd/retract_page_tables race](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6fa1066fc5d00cb9f1b0e83b7ff6ef98d26ba2aa)

## Affected kernel versions
- after 6.6, fixed on 6.6.58 (2024-10-22) and 6.11.5 (2024-10-22)

## Affected component, subsystem
- mm

## Cause
- race condition

## Related syscalls

- mremap
- madvise

## CVE URL

[NVD - CVE-2024-50066](https://nvd.nist.gov/vuln/detail/CVE-2024-50066)