# Vulneribility
 In function `find_equal_scalars`, it just call `copy_register_state` when found the same id.But it should not copy the `subreg_def` of the known_reg.



## Requirements to trigger the vulnerability
 - Kernel configuration: `CONFIG_BPF`
 - Are user namespaces needed?: No
  
## Commit which introduced the vulnerability
 - [commit 75748837b7e56919679e02163f45d5818c644d03](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/kernel/bpf/verifier.c?id=75748837b7e56919679e02163f45d5818c644d03)

## Commit which fixed the vulnerability
- [commit e9bd9c498cb0f5843996dbe5cbce7a1836a83c70](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=e9bd9c498cb0f5843996dbe5cbce7a1836a83c70)
- The patch is different in different target, e.g. for 6.6 it looks like [commit bfe9446ea1d95f6cb7848da19dfd58d2eec6fd84](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/kernel/bpf/verifier.c?h=linux-6.6.y&id=bfe9446ea1d95f6cb7848da19dfd58d2eec6fd84)
## Affected kernel versions
- v6.6-rc1 and later 
- v6.1-rc1 and later
- v5.10-rc1 and later 

## Affected component, subsystem
- bpf

## Cause
- out-of-bounds reads and writes

