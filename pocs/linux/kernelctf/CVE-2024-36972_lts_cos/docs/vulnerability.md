- Requirements:
    - Capabilites: None
    - Kernel configuration: CONFIG_AF_UNIX_OOB
    - User namespaces required: No
- Introduced by: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1279f9d9dec2d7462823a18c29ad61359e0a007d
- Fixed by: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9841991a446c87f90f66f4b9fee6fe934c1336a2
- Affected kernel versions: v6.8 - v6.9, v5.15.147, v6.1.78, v6.6.17
- Affected component: af_unix
- Syscall to disable: socket
- URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-36972
- Cause: Double Free
- Description: A double free vulnerability in the Linux kernel's af_unix. __unix_gc() tries to garbage-collect close()d inflight sockets,
and then if the socket has MSG_OOB in unix_sk(sk)->oob_skb, GC will drop the reference and set NULL to it locklessly.
However, the peer socket still can send MSG_OOB messages and queue_oob() can update unix_sk(sk)->oob_skb concurrently, leading double free.
We recommend upgrading past commit 9841991a446c87f90f66f4b9fee6fe934c1336a2