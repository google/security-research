KERNELXDK_INCLUDE_DIR ?= /usr/local/include
KERNELXDK_LIB_DIR ?= /usr/lib

CXX = g++
CXXFLAGS = -I. -I$(KERNELXDK_INCLUDE_DIR) -static -pthread -s
LDFLAGS = -L$(KERNELXDK_LIB_DIR) -lkernelXDK -lkeyutils

exploit: exploit.cpp target_db.kxdb
	$(CXX) $(CXXFLAGS) -o $@ $< $(LDFLAGS)

exploit_debug: exploit.cpp target_db.kxdb
	$(CXX) $(CXXFLAGS) -g -o $@ $< $(LDFLAGS)

target_db.kxdb:
	wget -O target_db.kxdb https://storage.googleapis.com/kernelxdk/db/kernelctf.kxdb

clean:
	rm -f exploit exploit_debug target_db.kxdb

.PHONY: clean
