# Vulnerability

CVE-2025-21702 is a vulnerability in the Linux kernel that occurs when the pfifo_tail_enqueue function is called on a scheduler with a limit of zero packets. This situation allows the queue length (qlen) of the scheduler to be incorrectly incremented without dropping any packets, violating the expected relationship between parent and child queue lengths

## Requirements to trigger the vulnerability:
- Capabilities: To trigger the vulnerability, `CAP_NET_ADMIN` and `CAP_NET_RAW` capabilities are required.
- Kernel configuration: `CONFIG_NET_SCHED` and `CONFIG_NET_SCH_FIFO` are required to trigger this vulnerability.
- Are user namespaces needed?: Yes. As this vulnerability requires `CAP_NET_ADMIN` and `CAP_NET_RAW`, which are not usually given to the normal user, we used the unprivileged user namespace to achieve this capability.

## Commit which introduced the vulnerability
- This vulnerability was introduced in Linux v2.6.34, with commit [57dbb2d83d10](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=57dbb2d83d10)
- This commit add head drop fifo queue to the kernel.

## Commit which fixed the vulnerability
- This vulnerability was fixed with commit [647cef20e649c576dff271e018d5d15d998b629d](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=647cef20e649c576dff271e018d5d15d998b629d)

## Affected kernel versions
- Linux version 2.6.34 - 6.13.2 affects to this vulnerability

## Affected component, subsystem
- Net scheduler subsystem
  
## Cause (UAF, BoF, race condition, double free, refcount overflow, etc)
- UAF