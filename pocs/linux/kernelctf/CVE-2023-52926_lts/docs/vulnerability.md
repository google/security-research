# Vulnerability
IORING_OP_READ did not correctly consume the provided buffer list when read i/o returned < 0 (except for -EAGAIN and -EIOCBQUEUED return). This can lead to a potential use-after-free when the completion via io_rw_done runs at separate context.

## Requirements to trigger the vulnerability
- Capabilities: NONE
- Kernel configuration: `CONFIG_IO_URING`
- User namespaces needed: No
  
## Commit which introduced the vulnerability
- https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit?id=c7fb19428d67d

## Commit which fixed the vulnerability
https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6c27fc6a783c8a77c756dd5461b15e465020d075

## Affected kernel versions
v6.6 - v6.6.67

## Affected component, subsystem
- io_uring

## Cause
- Use After Free