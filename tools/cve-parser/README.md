# CVE Parser for Google Security Research

A Python CLI tool that parses the [google/security-research](https://github.com/google/security-research) repository and extracts vulnerability metadata (CVE IDs, component types, and folder paths) into JSON and CSV formats.

## Features

- ğŸ” **Recursive scanning**: Scans specified folders and their subfolders
- ğŸ“„ **Multiple file types**: Processes `.md`, `.txt`, and `.patch` files
- ğŸ¯ **CVE detection**: Uses regex pattern `CVE-\d{4}-\d{4,7}` to identify CVE references
- ğŸ“Š **Multiple output formats**: Generates both JSON and CSV files
- ğŸ“ˆ **HTML reports**: Optional HTML summary with CVE statistics
- ğŸ—‚ï¸ **Component classification**: Automatically categorizes CVEs by folder structure
- ğŸ“… **Date extraction**: Attempts to extract dates from filenames and content
- âš¡ **Flexible scanning**: Can target specific folders or scan all top-level directories

## Requirements

- Python 3.7 or higher
- No external dependencies (uses only Python standard library)

## Installation

1. Clone this repository or download the `cve_parser.py` file
2. Ensure you have Python 3.7+ installed
3. Make the script executable (optional):
   ```bash
   chmod +x cve_parser.py
   ```

## Usage

### Basic Usage

```bash
python cve_parser.py --repo-dir /path/to/security-research --output-dir ./output
```

### Advanced Usage

```bash
# Scan specific folders only
python cve_parser.py --repo-dir ./security-research --output-dir ./results --folders kernel android chromium

# Generate HTML report
python cve_parser.py --repo-dir ./security-research --output-dir ./output --html-report

# Custom output filenames
python cve_parser.py --repo-dir ./security-research --output-dir ./output --json-file my_cves.json --csv-file my_cves.csv
```

### Command Line Options

|     Option      | Required    | Description |
|-----------------|-------------|
| `--repo-dir`    |      Yes    | Path to the local clone of the google/security-research repository |
| `--output-dir`  |      Yes    | Directory to save the generated JSON and CSV files |
| `--folders`     |       No    | List of specific folder names to scan (e.g., `kernel android chromium`)        |
| `--html-report` | No          | Generate an HTML summary report |
| `--json-file`   | No          | Name of the JSON output file (default: `cve_data.json`) |
| `--csv-file`    | No          | Name of the CSV output file (default: `cve_data.csv`) |

## Output Formats

### JSON Output

The JSON file contains an array of objects with the following structure:

```json
[
  {
    "cve_id": "CVE-2023-12345",
    "component": "kernel",
    "file_path": "kernel/some_bug/README.md",
    "date": "2023-01-15"
  },
  {
    "cve_id": "CVE-2022-67890",
    "component": "android",
    "file_path": "android/vulnerability/report.txt"
  }
]
```

### CSV Output

The CSV file contains the same data in tabular format:

```csv
cve_id,component,file_path,date
CVE-2023-12345,kernel,kernel/some_bug/README.md,2023-01-15
CVE-2022-67890,android,android/vulnerability/report.txt,
```

### HTML Report (Optional)

When `--html-report` is specified, an HTML file is generated with:
- Summary statistics (total CVE references, unique CVEs, components analyzed)
- Component breakdown table showing CVE counts per component
- Formatted, responsive design for easy viewing

## Examples

### Example 1: Basic Scan

```bash
# Clone the repository first
git clone https://github.com/google/security-research.git

# Run the parser
python cve_parser.py --repo-dir ./security-research --output-dir ./cve_analysis
```

This will:
- Scan all top-level folders in the repository
- Create `cve_data.json` and `cve_data.csv` in the `./cve_analysis` directory
- Display summary statistics in the terminal

### Example 2: Focused Analysis

```bash
# Scan only kernel and Android-related vulnerabilities
python cve_parser.py \
  --repo-dir ./security-research \
  --output-dir ./kernel_android_analysis \
  --folders kernel android \
  --html-report
```

### Example 3: Custom Output

```bash
# Use custom filenames and generate report
python cve_parser.py \
  --repo-dir ./security-research \
  --output-dir ./custom_output \
  --json-file security_cves.json \
  --csv-file security_cves.csv \
  --html-report
```

## Repository Structure Expected

The tool expects the google/security-research repository to have the following structure:

```
security-research/
â”œâ”€â”€ kernel/
â”‚   â”œâ”€â”€ CVE-2023-xxxx/
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â””â”€â”€ exploit.patch
â”‚   â””â”€â”€ ...
â”œâ”€â”€ android/
â”‚   â”œâ”€â”€ some-vulnerability/
â”‚   â”‚   â””â”€â”€ report.txt
â”‚   â””â”€â”€ ...
â”œâ”€â”€ chromium/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ exploits/
â”‚   â””â”€â”€ ...
â””â”€â”€ other-folders/
    â””â”€â”€ ...
```

## Features in Detail

### CVE Detection

The tool uses the regex pattern `CVE-\d{4}-\d{4,7}` to identify CVE references, which matches:
- Standard CVE format: `CVE-YYYY-NNNN` to `CVE-YYYY-NNNNNNN`
- Years from 1000-9999 (though typically 1999+)
- ID numbers from 4 to 7 digits

### Component Classification

Components are automatically determined based on the folder structure:
- Files in `/kernel/...` are classified as "kernel"
- Files in `/android/...` are classified as "android"
- Files in `/chromium/...` are classified as "chromium"
- And so on for other top-level folders

### Date Extraction

The tool attempts to extract dates from:
1. **Filenames**: Looks for patterns like `YYYY-MM-DD`, `YYYY_MM_DD`, `YYYYMMDD`
2. **File content**: Searches for date patterns and keywords like "Date:", "Published:", "Reported:"

### Error Handling

The tool includes robust error handling for:
- Missing directories
- Unreadable files
- Encoding issues
- Permission errors
- Invalid file formats

## Troubleshooting

### Common Issues

1. **"Repository directory not found"**
   - Ensure the `--repo-dir` path is correct
   - Check that you have read permissions for the directory

2. **"No folders found to scan"**
   - Verify the repository structure
   - Check if the specified folders exist in `--folders` option

3. **"No CVE data to save"**
   - The repository might not contain CVE references in the scanned files
   - Try scanning different folders or check file extensions

4. **Encoding errors**
   - The tool handles common encoding issues automatically
   - Files with unusual encodings are skipped with a warning

### Performance Notes

- Large repositories may take several minutes to scan
- The tool processes files sequentially for memory efficiency
- Progress is displayed during scanning

## Development

### Code Structure

- `CVEParser` class: Main parser logic
- `main()` function: CLI interface and argument parsing
- Modular design for easy extension and testing

### Extending the Tool

To add new file types, modify the `SCAN_EXTENSIONS` set:

```python
SCAN_EXTENSIONS = {'.md', '.txt', '.patch', '.py', '.c'}
```

To add new date patterns, extend the `_guess_date_from_filename` or `_extract_date_from_content` methods.

## License

This tool is provided as-is for educational and research purposes. Please respect the license of the google/security-research repository when using this tool.

## Contributing

Contributions are welcome! Please consider:
- Adding test cases
- Improving date extraction algorithms
- Adding support for additional file formats
- Enhancing the HTML report functionality

## Support

For issues or questions:
1. Check the troubleshooting section above
2. Review the command-line help: `python cve_parser.py --help`
3. Ensure you're using a compatible Python version (3.7+) 